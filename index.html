<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForexFactory Wirtschaftskalender</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #0056b3; color: white; }
    </style>
</head>
<body>
    <h2>üìä ForexFactory Wirtschaftskalender f√ºr heute</h2>
    <table id="forex-table">
        <thead>
            <tr>
                <th>Zeit</th>
                <th>W√§hrung</th>
                <th>Ereignis</th>
                <th>Wichtigkeit</th>
                <th>Vorherig</th>
                <th>Prognose</th>
                <th>Tats√§chlich</th>
            </tr>
        </thead>
        <tbody>
            <tr><td colspan="7">üîÑ Lade Daten...</td></tr>
        </tbody>
    </table>

    <script>
        async function fetchForexFactoryData() {
            try {
                console.log("üîÑ Lade ForexFactory-Kalender...");
                const response = await fetch("https://corsproxy.io/?https://www.forexfactory.com/calendar");
                const text = await response.text();

                const parser = new DOMParser();
                const doc = parser.parseFromString(text, "text/html");

                console.log("üìä HTML-Struktur geladen:", doc.body.innerHTML.substring(0, 500)); // Debugging

                const rows = doc.querySelectorAll(".calendar__row"); // Pr√ºfen, ob es Zeilen gibt

                if (!rows.length) {
                    console.error("‚ùå Keine Datenzeilen gefunden. √úberpr√ºfe die Selektoren!");
                    document.querySelector("#forex-table tbody").innerHTML = "<tr><td colspan='7'>‚ö† Keine Daten gefunden.</td></tr>";
                    return;
                }

                let tableContent = "";
                rows.forEach(row => {
                    const time = row.querySelector(".calendar__time")?.innerText.trim() || "N/A";
                    const currency = row.querySelector(".calendar__currency")?.innerText.trim() || "N/A";
                    const event = row.querySelector(".calendar__event")?.innerText.trim() || "N/A";
                    const impactElement = row.querySelector(".calendar__impact span");
                    const impact = impactElement ? impactElement.className : "Low";
                    const previous = row.querySelector(".calendar__previous")?.innerText.trim() || "N/A";
                    const forecast = row.querySelector(".calendar__forecast")?.innerText.trim() || "N/A";
                    const actual = row.querySelector(".calendar__actual")?.innerText.trim() || "N/A";

                    let impactText = impact.includes("high") ? "üî¥ Hoch" :
                                     impact.includes("moderate") ? "üü° Mittel" : "üü¢ Gering";

                    tableContent += `
                        <tr>
                            <td>${time}</td>
                            <td>${currency}</td>
                            <td>${event}</td>
                            <td>${impactText}</td>
                            <td>${previous}</td>
                            <td>${forecast}</td>
                            <td>${actual}</td>
                        </tr>
                    `;
                });

                document.querySelector("#forex-table tbody").innerHTML = tableContent || "<tr><td colspan='7'>‚ö† Keine Daten gefunden.</td></tr>";

            } catch (error) {
                console.error("‚ùå Fehler beim Laden der Forex-Daten:", error);
                document.querySelector("#forex-table tbody").innerHTML = "<tr><td colspan='7'>‚ùå Fehler beim Laden der Daten.</td></tr>";
            }
        }

        fetchForexFactoryData();
    </script>
</body>
</html>

